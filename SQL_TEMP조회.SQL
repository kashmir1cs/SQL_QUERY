--SQL 작성 : DBeaver 활용 (ORACLE DB)
SELECT 
	A.AREA_CD 
	,MIN(A.MIN_TEMPER) AS MIN_TEMPER 
	,MAX(A.MAX_TEMPER) AS MAX_TEMPER 
FROM TB_TEMPER A
WHERE A.AREA_CD='108' --지역코드 조건
GROUP BY A.AREA_CD 
;

SELECT 
	 A.AREA_CD 
	,A.MIN_TEMPER AS MIN_TEMP
	,A.MAX_TEMPER AS MAX_TEMP
FROM TB_TEMPER A
WHERE A.AREA_CD='108' --지역코드 조건
GROUP BY A.AREA_CD 
;



SELECT --최고/최저온도에 해당하는 날짜와 그 지역의 코드를 출력 
	 B.AREA_CD  
	,B.STD_DE
	,B.MIN_TEMPER
	,B.MAX_TEMPER
	 FROM --SELECT 이중으로 활용
	 	(
	 	  SELECT
	 	  	 A.AREA_CD
	 	    ,MIN(A.MIN_TEMPER) AS MIN_TEMPER
	 	    ,MAX(A.MAX_TEMPER) AS MAX_TEMPER
	 	  FROM TB_TEMPER A --TEMPER 저장 TABLE을 A라 지칭
	 	  WHERE A.AREA_CD = '108'
	 	  GROUP BY A.AREA_CD 
	 	) A
	 	, TB_TEMPER B
	 WHERE (B.AREA_CD= A.AREA_CD AND B.MIN_TEMPER=A.MIN_TEMPER) --SELF JOIN기법
	 	OR (B.AREA_CD=A.AREA_CD AND B.MAX_TEMPER=A.MAX_TEMPER)
;
